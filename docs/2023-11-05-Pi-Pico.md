---
date: "2023-11-05"
title: "Pi Pico"
---
<!-- markdownlint-disable MD025 -->
# Pi Pico
<!-- markdownlint-enable MD025 -->

# Embedded HALs

There appear to be 2 completely different HALs/APIs/ecosystems for supporting
Raspberry Pi Picos. 

* [Embassy RP HAL implements both blocking and async APIs for many peripherals](https://github.com/embassy-rs/embassy/tree/main/embassy-rp)
* [Rust support for the "Raspberry Silicon" family of microcontrollers](https://github.com/rp-rs/rp-hal)

These are not compatible, see [Embassy-RP and RP2040-hal Compatibility?](https://github.com/embassy-rs/embassy/issues/3180) and [Embassy-RP and RP2040-hal Compatibility?](https://github.com/rp-rs/rp-hal/issues/816)

## Networking

[Resilient MicroPython WiFi code](https://github.com/peterhinch/micropython-samples/blob/master/resilient/README.md)

[Microdot “The impossibly small web framework for Python and MicroPython”](https://microdot.readthedocs.io/en/latest/index.html)

## pio

### rust

[pio-rs](https://github.com/rp-rs/pio-rs) note: "you can call pio::assembler::new() and construct a pio program using the 'builder pattern' - effectively you are compiling a pio program at run-time on the rp2040 itself!"

### Teaching

Comprehensive learning PIO youtube series from [Life with David](https://www.youtube.com/playlist?list=PLiRALtgGsxmZs_LXGkh09Zr2NUmk_mtEI)

JMP and X,Y scratch registers for the win!

[In-depth: Raspberry Pi Pico's PIO - programmable I/O!](https://www.youtube.com/watch?v=yYnQYF_Xa8g)

[Raspberry Pico: Programming with PIO State Machines](https://admantium.com/blog/pico09_pio/)

[Playing with the Pico Part 4 - Getting Acquainted with PIO](https://gregchadwick.co.uk/blog/playing-with-the-pico-pt4/) and [Playing with the Pico Part 5 - Producing VGA Video](https://gregchadwick.co.uk/blog/playing-with-the-pico-pt5/)

[A Practical Look at PIO on the Raspberry Pi Pico](https://dev.to/blues/a-practical-look-at-pio-on-the-raspberry-pi-pico-50j8)

### Simulators, Emulators

RP2040 PIO Emulator [Github](https://github.com/soundpaint/rp2040pio) and [Read the Docs](https://rp2040pio-docs.readthedocs.io/en/latest/index.html)

### Examples with explanations

[Raspberry Pi Pico PIO Quadrature Encoder](https://github.com/jamon/pi-pico-pio-quadrature-encoder)

Raspberry Pi Pico forum thread on [Pico Counter Module](https://forums.raspberrypi.com/viewtopic.php?t=307715)

Long discussion here about frequency counters, irq, etc plus a fair bit of code [Reciprocal frequency counter](https://forums.raspberrypi.com/viewtopic.php?t=306250)

"I'm trying to make a tachometer" [Measuring frequency using the Pico](https://forums.raspberrypi.com/viewtopic.php?t=347567)

Can also use PWM for fequency measurement [](https://abyz.me.uk/picod/py_picod.html#pwm_read_high_edges)

[pico micropython examples - pio](https://github.com/raspberrypi/pico-micropython-examples/tree/master/pio)


[Implementing composite video output using the Pi Pico's PIO](https://areed.me/posts/2021-07-14_implementing_composite_video_output_using_the_pi_picos_pio/)

## Install Raspberry Pi Pico

<!-- markdownlint-disable MD034 -->
https://learn.pimoroni.com/article/pico-development-using-wsl
<!-- markdownlint-enable MD034 -->

after you've made the various standard Raspberry Pi examples, I suggest that you copy over the hello_world/usb example.

Now it's time to install the necessary software for the usb exmple to test out serial communication. I suggest that you [PuTTY](https://www.chiark.greenend.org.uk/~sgtatham/putty/latest.html) to test out the connection on the Windows side.

On Windows run the "Device Manager" and expand the Ports (COM & LPT) section. Note the COM port number for the Pico; on my system it's labelled "USB Serial Device (COM7)".

Open PuTTY, select the Serial connection type and enter the COM7 (see above) in the Serial line box. Set the Speed to 115200 and click on the Open button. A window should open that repetively prints "Hello, World!".

Now it's time to deal with the WSL side of things.

<!-- markdownlint-disable MD034 -->
https://github.com/dorssel/usbipd-win
<!-- markdownlint-enable MD034 -->

```cmd
winget install usbipd
```

<!-- markdownlint-disable MD034 -->
https://github.com/dorssel/usbipd-win/wiki/WSL-support
<!-- markdownlint-enable MD034 -->

```ubuntu
sudo apt install linux-tools-virtual hwdata
sudo update-alternatives --install /usr/local/bin/usbip usbip `ls /usr/lib/linux-tools/*/usbip | tail -n1` 20
```

```cmd
usbipd wsl list
# look for Picoprobe entry, like this:
# 1-2    2e8a:0004  USB Serial Device (COM5), Picoprobe
# you might not need the "--distribution ubuntu" part if you only have one WSL distribution installed
usbipd wsl attach --busid 1-2 --distribution ubuntu
```

### openocd

```ubuntu
$ sudo apt install automake autoconf build-essential texinfo libtool libftdi-dev libusb-1.0-0-dev
sudo apt install pkg-config # missing on my WSL ubuntu
$ git clone https://github.com/raspberrypi/openocd.git --branch rp2040-v0.12.0 --depth=1 --no-single-branch
cd openocd
./bootstrap
./configure
make -j8
sudo make install
```

## Build

`cmake -DPICO_BOARD=pico_w ..` for Pico W

## Additional Packages

In [micropython-lib](https://github.com/micropython/micropython-lib) there are bunch of sub directories that can be isntalled. First the Pico has to be connected to the internet.

```python
# connect to device on mpremote
# connect to internet
import mip
mip.install("aiorepl") # for example
```

if the Micropython device isn't network connected then the host machine can be used instead.

```python
import mip
mpremote mip install pkgname
```

A bunch of interesting Micropython stuff by [Peter Hinch](https://github.com/peterhinch), a retired hardware and firmware developer, [here](https://github.com/peterhinch/micropython-samples). This includes [mqtt](https://github.com/peterhinch/micropython-mqtt) [gui for tiny screens](https://github.com/peterhinch/micropython-micro-gui) and [async information](https://github.com/peterhinch/micropython-async).

## Links

<!-- markdownlint-disable MD034 -->
<!-- markdownlint-enable MD034 -->
